version: '3.8'

services:
  # -------------------- BACKEND SERVICE --------------------
  backend:
    container_name: food_backend
    # üü¢ KH·ªêI BUILD ƒê√É ƒê∆Ø·ª¢C TH√äM L·∫†I
    build: 
      context: ./backend 
      dockerfile: Dockerfile
    # üü¢ KH·ªêI env_file ƒê√É ƒê∆Ø·ª¢C TH√äM L·∫†I
    env_file:
      - ./backend/.env
    ports:
      - "4000:10000" # Mapp c·ªïng 10000 (container) ra c·ªïng 4000 (host)
    environment:
      # S·ª≠a URL redirect c·ªßa Stripe
      FRONTEND_URL: http://localhost
      ADMIN_URL: http://localhost:8080

  # -------------------- FRONTEND SERVICE (CLIENT) --------------------
  frontend:
    container_name: food_frontend
    build: 
      context: ./frontend
      dockerfile: Dockerfile
      args: 
        # C·∫•u h√¨nh g·ªçi API t·ª´ tr√¨nh duy·ªát Host
        - VITE_API_URL=http://localhost:4000 
    ports:
      - "80:80" 
    depends_on:
      - backend

  # -------------------- ADMIN SERVICE (DASHBOARD) --------------------
  admin:
    container_name: food_admin
    build: 
      context: ./admin
      dockerfile: Dockerfile
      args:
        # C·∫•u h√¨nh g·ªçi API t·ª´ tr√¨nh duy·ªát Host
        - VITE_API_URL=http://localhost:4000 
    ports:
      - "8080:80" 
    depends_on:
      - backend